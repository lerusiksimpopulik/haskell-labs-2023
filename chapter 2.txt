--2.1
SELECT DISTINCT MANUFACTURER.COMPANY AS MANUFACTURER
FROM MANUFACTURER
INNER JOIN PRODUCT
ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
WHERE PRODUCT.WARE = 'Drinking water'
ORDER BY MANUFACTURER;
--2.2
SELECT DISTINCT COMPANY, PRODUCT.WARE
FROM MANUFACTURER
JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
JOIN CATEGORY ON PRODUCT.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS = "Raw food"
ORDER BY PRODUCT.WARE, COMPANY;
--2.3
SELECT DISTINCT PRODUCT.WARE
FROM PRODUCT
JOIN MATERIAL ON PRODUCT.BILL_ID = MATERIAL.BILL_ID
JOIN CATEGORY ON MATERIAL.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS = 'Mineral'
ORDER BY PRODUCT.WARE;
--2.4
SELECT MANUFACTURER.COMPANY
FROM MANUFACTURER
JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
JOIN CATEGORY ON PRODUCT.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS IN ('Fuel', 'Food')
GROUP BY MANUFACTURER.COMPANY
HAVING COUNT(DISTINCT CATEGORY.CLASS) = 2;
--2.5
SELECT DISTINCT MANUFACTURER.COMPANY, CATEGORY.CLASS, PRODUCT.WARE
FROM MANUFACTURER
JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
JOIN CATEGORY ON PRODUCT.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS IN ('Fuel', 'Food')
GROUP BY MANUFACTURER.COMPANY, CATEGORY.CLASS, PRODUCT.WARE
HAVING COUNT(DISTINCT CATEGORY.CLASS) >= 1
ORDER BY MANUFACTURER.COMPANY, CATEGORY.CLASS, PRODUCT.WARE;
--2.6
SELECT COMPANY
FROM MANUFACTURER
JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
JOIN CATEGORY ON PRODUCT.WARE = CATEGORY.WARE
GROUP BY COMPANY, CATEGORY.CLASS
HAVING COUNT(DISTINCT PRODUCT.WARE) >= 2
ORDER BY COMPANY;
--2.7
SELECT DISTINCT PRODUCT.WARE
FROM PRODUCT
JOIN MATERIAL ON PRODUCT.BILL_ID = MATERIAL.BILL_ID
JOIN CATEGORY ON MATERIAL.WARE = CATEGORY.WARE
GROUP BY PRODUCT.WARE
HAVING SUM(CASE WHEN CATEGORY.CLASS <> 'Mineral' THEN 1 ELSE 0 END) = 0
ORDER BY PRODUCT.WARE;
--2.8
SELECT DISTINCT MANUFACTURER.COMPANY
FROM MANUFACTURER
JOIN PRODUCT AS Product1 ON MANUFACTURER.BILL_ID = Product1.BILL_ID
JOIN MATERIAL AS Material1 ON Product1.WARE = Material1.WARE
JOIN PRODUCT AS Product2 ON Material1.BILL_ID = Product2.BILL_ID
ORDER BY COMPANY;
--2.9
SELECT DISTINCT MANUFACTURER.COMPANY, P1.WARE AS 'Initial Product', M1.WARE AS 'Intermediate Material', P2.WARE AS 'Final Product'
FROM MANUFACTURER
JOIN PRODUCT AS P1 ON MANUFACTURER.BILL_ID = P1.BILL_ID
JOIN MATERIAL AS M1 ON P1.WARE = M1.WARE
JOIN PRODUCT AS P2 ON M1.BILL_ID = P2.BILL_ID
ORDER BY M1.WARE, P1.WARE, P2.WARE;
