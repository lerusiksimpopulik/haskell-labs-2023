--2.1
SELECT DISTINCT MANUFACTURER.COMPANY AS MANUFACTURER
FROM MANUFACTURER
INNER JOIN PRODUCT
ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
WHERE PRODUCT.WARE = 'Drinking water'
ORDER BY MANUFACTURER;
--2.2
SELECT DISTINCT COMPANY, PRODUCT.WARE
FROM MANUFACTURER
JOIN PRODUCT ON MANUFACTURER.BILL_ID = PRODUCT.BILL_ID
JOIN CATEGORY ON PRODUCT.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS = "Raw food"
ORDER BY PRODUCT.WARE, COMPANY;
--2.3
SELECT DISTINCT PRODUCT.WARE
FROM PRODUCT
JOIN MATERIAL ON PRODUCT.BILL_ID = MATERIAL.BILL_ID
JOIN CATEGORY ON MATERIAL.WARE = CATEGORY.WARE
WHERE CATEGORY.CLASS = 'Mineral'
ORDER BY PRODUCT.WARE;
--2.4
SELECT DISTINCT MANUFACTURER.COMPANY
FROM CATEGORY, PRODUCT, MANUFACTURER
WHERE CATEGORY.CLASS LIKE "FUEL" AND PRODUCT.WARE == CATEGORY.WARE
INTERSECT
SELECT DISTINCT MANUFACTURER.COMPANY
FROM CATEGORY, PRODUCT, MANUFACTURER
WHERE CATEGORY.CLASS LIKE "FOOD" AND PRODUCT.WARE == CATEGORY.WARE
--2.5
SELECT DISTINCT MANUFACTURER.COMPANY
FROM CATEGORY, MANUFACTURER
LEFT JOIN PRODUCT p1 ON MANUFACTURER.BILL_ID==p1.BILL_ID AND CATEGORY.CLASS LIKE "FUEL" AND p1.WARE == CATEGORY.WARE
LEFT JOIN PRODUCT p2 ON MANUFACTURER.BILL_ID==p2.BILL_ID AND CATEGORY.CLASS LIKE "FOOD" AND p2.WARE == CATEGORY.WARE
--2.6
SELECT DISTINCT MANUFACTURER.COMPANY
FROM CATEGORY fst, CATEGORY snd, PRODUCT, MANUFACTURER
WHERE fst.WARE<>snd.WARE AND fst.CLASS == snd.CLASS AND (PRODUCT.WARE == fst.WARE OR PRODUCT.WARE == snd.WARE) AND PRODUCT.BILL_ID==MANUFACTURER.BILL_ID
ORDER BY MANUFACTURER.COMPANY ASC
--2.7
SELECT DISTINCT PRODUCT.WARE
FROM CATEGORY, PRODUCT
WHERE CATEGORY.CLASS LIKE "MINERAL" AND PRODUCT.WARE == CATEGORY.WARE
EXCEPT
SELECT DISTINCT PRODUCT.WARE
FROM CATEGORY, PRODUCT
WHERE CATEGORY.CLASS NOT LIKE "MINERAL" AND PRODUCT.WARE == CATEGORY.WARE
ORDER BY PRODUCT.WARE ASC
--2.8
SELECT DISTINCT MANUFACTURER.COMPANY
FROM MANUFACTURER
JOIN PRODUCT AS Product1 ON MANUFACTURER.BILL_ID = Product1.BILL_ID
JOIN MATERIAL AS Material1 ON Product1.WARE = Material1.WARE
JOIN PRODUCT AS Product2 ON Material1.BILL_ID = Product2.BILL_ID
ORDER BY COMPANY;
--2.9
SELECT DISTINCT MANUFACTURER.COMPANY, P1.WARE AS 'Initial Product', M1.WARE AS 'Intermediate Material', P2.WARE AS 'Final Product'
FROM MANUFACTURER
JOIN PRODUCT AS P1 ON MANUFACTURER.BILL_ID = P1.BILL_ID
JOIN MATERIAL AS M1 ON P1.WARE = M1.WARE
JOIN PRODUCT AS P2 ON M1.BILL_ID = P2.BILL_ID
ORDER BY M1.WARE, P1.WARE, P2.WARE;
